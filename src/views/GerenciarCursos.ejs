<!DOCTYPE html>
<html lang="en">
<head>
   <%- include('../partials/head'); %>
   <style>
    section {
      margin: 20px 50px 0px 50px;
      margin-top: 20px;
    }
    .courses-list {
      list-style: none;
      padding: 0;
      margin: 20px 0;
    }
    
    .courses-list li {
      padding: 10px 0;
    }
    
    .courses-list a {
      text-decoration: none;
      color: #007bff;
    }

    .courses-list a:hover {
      text-decoration: underline;
    }

    .btn-close-small {
      transform: scale(0.75); 
      margin-right: 5px;
    }
   </style>
</head>
<body class="container">
    <header>
        <%- include('../partials/headerSecretaria'); %>
    </header>

   
  <section>
  

    <ul class="courses-list">
      <h4>Cursos-graduação:</h4>
      <li><a href="#" data-bs-toggle="modal" data-bs-target="#exampleModal">Administração</a></li>
      <li><a href="#" data-bs-toggle="modal" data-bs-target="#exampleModal">Biomedicina</a></li>
      <li><a href="#" data-bs-toggle="modal" data-bs-target="#exampleModal">Direito</a></li>
      <li><a href="#" data-bs-toggle="modal" data-bs-target="#exampleModal">Enfermagem</a></li>
      <li><a href="#" data-bs-toggle="modal" data-bs-target="#exampleModal">Engenharia de Software</a></li>
      <li><a href="#" data-bs-toggle="modal" data-bs-target="#exampleModal">Engenharia Civil</a></li>
      <li><a href="#" data-bs-toggle="modal" data-bs-target="#exampleModal">Engenharia Química</a></li>
      <li><a href="#" data-bs-toggle="modal" data-bs-target="#exampleModal">Engenharia Mecânica</a></li>
      <li><a href="#" data-bs-toggle="modal" data-bs-target="#exampleModal">Fisioterapia</a></li>
      <li><a href="#" data-bs-toggle="modal" data-bs-target="#exampleModal">Medicina</a></li>
      <li><a href="#" data-bs-toggle="modal" data-bs-target="#exampleModal">Medicina Veterinária</a></li>
      <li><a href="#" data-bs-toggle="modal" data-bs-target="#exampleModal">Psicologia</a></li>
      <li><a href="#" data-bs-toggle="modal" data-bs-target="#exampleModal">Sistemas de Informação</a></li>
    </ul>
  </section>

 
  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel">Informações do Curso</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="periodo">Selecione o período:</label>
            <select id="periodo" name="periodo" class="form-select" required>
              <option value="">Selecione o período</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
              <option value="7">7</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="10">10</option>
              <option value="11">11</option>
              <option value="12">12</option>
            </select>
          </div>
          <div class="container mt-4">
            <p>
              <button type="button" class="btn-close btn-close-small" aria-label="Close"></button>
              Disciplina 1
            </p>
            <p>
              <button type="button" class="btn-close btn-close-small" aria-label="Close"></button>
              Disciplina 2
            </p>
            <p>
              <button type="button" class="btn-close btn-close-small" aria-label="Close"></button>
              Disciplina 3
            </p>
            <p>
              <button type="button" class="btn-close btn-close-small" aria-label="Close"></button>
              Disciplina 4
            </p>
            <p>
              <button type="button" class="btn-close btn-close-small" aria-label="Close"></button>
              Disciplina 5
            </p>
            <p>
              <button type="button" class="btn-close btn-close-small" aria-label="Close"></button>
              Disciplina 6
            </p>
            <button type="button" class="btn btn-primary mt-3" data-bs-toggle="modal" data-bs-target="#addDisciplineModal" style="background-color: rgb(115, 115, 141); width: 100%; border-color: rgb(115, 115, 141);">
              Adicionar Disciplina <i class="fa-solid fa-plus" style="color: #ffffff;"></i>
            </button>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" style="background-color: rgb(115, 115, 141); border-color: rgb(115, 115, 141); width: 100%;" class="btn btn-primary">Salvar mudanças</button>
        </div>
      </div>
    </div>
  </div>

 
  <div class="modal fade" id="addDisciplineModal" tabindex="-1" aria-labelledby="addDisciplineModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="addDisciplineModalLabel">Adicionar Disciplina</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="disciplineName">Nome da Disciplina:</label>
            <input type="text" id="disciplineName" name="disciplineName" class="form-control" placeholder="Digite o nome da disciplina">
          </div>
          <div class="form-group">
            <label for="disciplinePeriod">Selecione o período:</label>
            <select id="disciplinePeriod" name="disciplinePeriod" class="form-select" required>
              <option value="">Selecione o período</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
              <option value="7">7</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="10">10</option>
              <option value="11">11</option>
              <option value="12">12</option>
            </select>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="button" class="btn btn-primary" id="confirmAddDisciplineButton">Adicionar</button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>
  <script>
    document.getElementById('confirmAddDisciplineButton').addEventListener('click', function() {
      const disciplineName = document.getElementById('disciplineName').value;
      const disciplinePeriod = document.getElementById('disciplinePeriod').value;
      
      if (!disciplineName || !disciplinePeriod) {
        alert('Por favor, preencha todos os campos.');
        return;
      }
  
      // Adicione a nova disciplina (emisssão para o backend)
      fetch('/disciplinas', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          name: disciplineName,
          period: disciplinePeriod
        })
      })
      .then(response => response.json())
      .then(data => {
        console.log('Disciplina adicionada:', data);
        // Fechar o modal
        const addDisciplineModal = new bootstrap.Modal(document.getElementById('addDisciplineModal'));
        addDisciplineModal.hide();
  
        // Atualizar a lista de disciplinas
        updateDisciplineList();
      })
      .catch(error => console.error('Erro ao adicionar disciplina:', error));
    });
  
    function updateDisciplineList() {
      const periodo = document.getElementById('periodo').value;
      
      fetch(`/disciplinas/${periodo}`)
      .then(response => response.json())
      .then(data => {
        const disciplinesContainer = document.querySelector('.container.mt-4');
        disciplinesContainer.innerHTML = '';
  
        data.disciplinas.forEach(discipline => {
          const p = document.createElement('p');
          p.innerHTML = `
            <button type="button" class="btn-close btn-close-small" aria-label="Close" onclick="deleteDiscipline(${discipline.id})"></button>
            ${discipline.name}
          `;
          disciplinesContainer.appendChild(p);
        });
  
        const addButton = document.createElement('button');
        addButton.type = 'button';
        addButton.className = 'btn btn-primary mt-3';
        addButton.dataset.bsToggle = 'modal';
        addButton.dataset.bsTarget = '#addDisciplineModal';
        addButton.style.backgroundColor = 'rgb(115, 115, 141)';
        addButton.style.width = '100%';
        addButton.style.borderColor = 'rgb(115, 115, 141)';
        addButton.innerHTML = 'Adicionar Disciplina <i class="fa-solid fa-plus" style="color: #ffffff;"></i>';
        disciplinesContainer.appendChild(addButton);
      })
      .catch(error => console.error('Erro ao atualizar disciplinas:', error));
    }
  
    function deleteDiscipline(disciplineId) {
      fetch(`/disciplinas/${disciplineId}`, {
        method: 'DELETE'
      })
      .then(response => response.json())
      .then(data => {
        console.log('Disciplina deletada:', data);
        updateDisciplineList();
      })
      .catch(error => console.error('Erro ao deletar disciplina:', error));
    }
  
    document.getElementById('periodo').addEventListener('change', updateDisciplineList);
  </script>
  
</body>
</html>
