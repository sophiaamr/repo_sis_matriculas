<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('./partials/head.ejs'); %>
    <style>
        .section-header {
            margin-bottom: 20px;
        }

        .section-header h4 {
            font-size: 1.5rem;
            color: rgb(115, 115, 141);
        }

        .form-section {
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .form-control {
            border-radius: 5px;
        }

        .btn-primary {
            background-color: rgb(115, 115, 141);
            border: none;
            border-radius: 5px;
        }

        .btn-primary:hover {
            background-color: rgb(90, 90, 115);
        }

        .form-group p {
            margin-bottom: 0;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .form-section {
                padding: 15px;
            }
        }
    </style>
</head>
<body class="container">
    <header>
        <%- include('./partials/headerSecretaria'); %>
    </header>
    <section class="container mt-4">
        <!-- Alterar Período de Matrículas -->
        <div class="form-section">
            <div class="section-header">
                <h4>Alterar Período de Matrículas</h4>
            </div>
            <form id="matriculaForm">
                <div class="row">
                    <div class="col-12 col-md-6 mb-3">
                        <div class="form-group">
                            <label for="startDate">Data de início:</label>
                            <input type="date" class="form-control" id="startDate" name="startDate" required>
                        </div>
                    </div>
                    <div class="col-12 col-md-6 mb-3">
                        <div class="form-group">
                            <label for="endDate">Data de fim:</label>
                            <input type="date" class="form-control" id="endDate" name="endDate" required>
                        </div>
                    </div>
                    <div class="col-12 mt-4">
                        <button type="submit" class="btn btn-primary">Alterar</button>
                    </div>
                </div>
            </form>
        </div>

        <!-- Alterar data de emissão de boletos -->
        <div class="form-section">
            <div class="section-header">
                <h4>Alterar data de emissão de boletos</h4>
            </div>
            <form id="boletoForm">
                <div class="row">
                    <div class="col-12 col-md-6 mb-3">
                        <div class="form-group">
                            <label for="faturaDate">Data de emissão:</label>
                            <input type="date" class="form-control" id="faturaDate" name="faturaDate" required>
                        </div>
                    </div>
                    <div class="col-12 col-md-6 mb-3">
                        <div class="form-group">
                            <label for="dataDeVencimento">Data de vencimento:</label>
                            <input type="date" class="form-control" id="dataDeVencimento" name="dataDeVencimento" required>
                        </div>
                    </div>
                    <div class="col-12 mt-4">
                        <button type="submit" class="btn btn-primary">Alterar</button>
                    </div>
                </div>
            </form>
        </div>
    </section>

    <!-- Modal de Confirmação -->
    <div class="modal fade" id="confirmationModal" tabindex="-1" aria-labelledby="confirmationModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="confirmationModalLabel">Confirmação</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    As datas foram alteradas com sucesso.
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                </div>
            </div>
        </div>
    </div>

    <script>
      // Form submission for Matricula
document.getElementById('matriculaForm').addEventListener('submit', async function (event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = {
        startDate: formData.get('startDate'),
        endDate: formData.get('endDate')
    };

    try {
        const response = await fetch('/api/Outros/datas/matricula', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        });

        if (response.ok) {
            const confirmationModal = new bootstrap.Modal(document.getElementById('confirmationModal'));
            confirmationModal.show();
        } else {
            const error = await response.json();
            console.error('Erro ao alterar datas de matrícula:', error);
            alert('Erro ao alterar datas de matrícula: ' + error.error);
        }
    } catch (err) {
        console.error('Erro ao enviar dados de matrícula:', err);
        alert('Erro ao alterar datas de matrícula.');
    }
});

// Form submission for Boleto
document.getElementById('boletoForm').addEventListener('submit', async function (event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = {
    faturaDate: formData.get('faturaDate'),
    dataDeVencimento: formData.get('dataDeVencimento')
};



    try {
        const response = await fetch('/api/Outros/datas/boleto', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        });

        if (response.ok) {
            const confirmationModal = new bootstrap.Modal(document.getElementById('confirmationModal'));
            confirmationModal.show();
        } else {
            const error = await response.json();
            console.error('Erro ao alterar datas de boletos:', error);
            alert('Erro ao alterar datas de boletos: ' + error.error);
        }
    } catch (err) {
        console.error('Erro ao enviar dados de boletos:', err);
        alert('Erro ao alterar datas de boletos.');
    }
});

    </script>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>
</body>
</html>
